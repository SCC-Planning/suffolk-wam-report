---
title: "WIP: Suffolk Annual Waste Monitoring Report 21/22"
scctemplate:
  header:
    site_branding: "Suffolk County Council"
  navigation:
    breadcrumb_trail:
      - href: "index.html"
        text: "WIP: SWAMR"
editor_options: 
  markdown: 
    wrap: sentence
---

\newpage

# Introduction

The Suffolk Minerals & Waste Local Plan was adopted in July 2020.
The Plan contains a Vision explaining how the County will meet its statutory obligation for the supply of aggregates and the sustainable management of waste.

It contains policies for determining planning application for minerals and waste development and identifies sites for future development for these uses.

It is important to understand whether the policies in the Plan are being delivered as intended and the extent to which the waste arisings and movements that were forecast are correct.
Because of the nature of waste data, such forecasts will never be exact, but trends can be identified and broad conclusions reached.

The Plan identifies sites that are suitable for the management of waste and this Monitoring Report will examine whether such sites have been taken forward for this use, or whether the policies should be amended in a future Plan.

The Local Plan contains a Policy Monitoring Framework which identifies the Performance Indicators that will be used to monitor the Plan which are the number of times that the relevant policies are triggered in the decision-making process.

Suffolk County Council also has a Development Management Local Monitoring and Enforcement Plan, adopted in 2016.
This sets out how the Council deals with the monitoring of developments as they are delivered including site visits to ensure that planning conditions are being carried out as intended.

This report looks at the effectiveness of the waste policies in delivering the policy outcomes in the Plan. In particular it examines whether Suffolk is net self-sufficient in the management of the waste arising with the Plan Area or whether additional waste management facilities are required to achieve this.

## Coronavirus (COVID-19): The impact of the pandemic on local authority waste collection and services

When reading this report, and especially when comparing annual totals between 2020/21 and 2021/22, the context of the pandemic should be taken into account.

The COVID-19 pandemic, which commenced in March 2020, caused disruption to local authority waste collection services. Services were heavily disrupted during April to June 2020.

As restrictions eased through the summer and into the autumn of 2020, local authorities and businesses acclimatised to working under lockdown conditions, and there was less disruption to services in the remainder of 2020. During 2021 lockdown restrictions were eased and despite further waves of infection there was less disruption to waste services.

Wider issues, such as the state of the economy during the pandemic will also have had an effect on the amount of waste generated.

A [full timeline of the UK government coronavirus lockdown](https://www.instituteforgovernment.org.uk/sites/default/files/2022-12/timeline-coronavirus-lockdown-december-2021.pdf) is available. A more in-depth analysis of the impact of the COVID-19 pandemic on waste services is given in the [Local authority collected waste management - annual results 2021/22 report](https://www.gov.uk/government/statistics/local-authority-collected-waste-management-annual-results-202122/local-authority-collected-waste-management-annual-results-202122#coronavirus-covid-19-the-impact-of-the-pandemic-on-local-authority-waste-collection-and-services) from the Department for Environment Food & Rural Affairs (DEFRA).

\newpage

# Methodology

## Data Sources
- The Local Authority Collected Waste annual results found under [ENV18 - Local Authority Collected Waste](https://www.gov.uk/government/statistical-data-sets/env18-local-authority-collected-waste-annual-results-tables-202122), produced by DEFRA, for Section 3. These annual results are published alongside a [national statistical report](https://www.gov.uk/government/statistics/local-authority-collected-waste-management-annual-results-202122/local-authority-collected-waste-management-annual-results-202122#coronavirus-covid-19-the-impact-of-the-pandemic-on-local-authority-waste-collection-and-services).
- The [WasteDataFlow - Local Authority waste management](https://www.data.gov.uk/dataset/0e0c12d8-24f6-461f-b4bc-f6d6a5bf2de5/wastedataflow-local-authority-waste-management) dataset, covering collection and recycling of waste based on a quarterly survey from local authorities, for section 3.3.
- The [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator), produced by the Environment Agency, for Sections 4 and 5.
- The [Remaining Landfill Capacity 2019-2021](https://www.data.gov.uk/dataset/237825cb-dc10-4c53-8446-1bcd35614c12/remaining-landfill-capacity) dataset produced by the Environment Agency for Section 4.3.

## Code

This report was generated in R Markdown. The source code for this report, all figures and calculations are provided in a [Github repository](https://github.com/SCC-Planning/wamreport). Full documentation is provided, and will allow other local authorities in England to generate their own annual waste monitoring report by adapting the code.

```{r setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE) 
options(scipen = 999)
```

```{r reading_wdi, include = FALSE}
lacw <- wamreport$lacw
# Reading in and combining relevant data
districts <- c(
  "Ipswich Borough Council",
  "Mid Suffolk District Council",
  "East Suffolk Council",
  # Waveney and SCDC merged into East in 19-20
  "Waveney District Council",
  "Suffolk Coastal District Council",
  # Forest Heath and St Edmunsbury mered into West in 19-20
  "West Suffolk Council",
  "Forest Heath District Council",
  "St Edmundsbury Borough Council"
)

lacw_suffolk <- lacw |>
  dplyr::filter(`Local Authority` %in% districts)

# Changing names to allow aggregating of former District Councils
lacw_suffolk$`Local Authority` <- gsub(
  "Waveney District Council",
  "East Suffolk Council",
  lacw_suffolk$`Local Authority`
)

lacw_suffolk$`Local Authority` <- gsub(
  "Suffolk Coastal District Council",
  "East Suffolk Council",
  lacw_suffolk$`Local Authority`
)

lacw_suffolk$`Local Authority` <- gsub(
  "Forest Heath District Council",
  "West Suffolk Council",
  lacw_suffolk$`Local Authority`
)

lacw_suffolk$`Local Authority` <- gsub(
  "St Edmundsbury Borough Council",
  "West Suffolk Council",
  lacw_suffolk$`Local Authority`
)

lacw_suffolk <- lacw_suffolk |>
  dplyr::select(-Region, -`ONS Code`, -`JPP order`, -`Authority type`) |>
  dplyr::group_by(`Financial Year`, `Local Authority`) |>
  dplyr::summarise(across(everything(), sum), .groups = "drop")

lacw_scc <- lacw |>
  dplyr::filter(`Local Authority` == "Suffolk County Council")

lacw_scc_21 <- lacw_scc |>
  dplyr::filter(`Financial Year` == "2021-22") |>
  dplyr::select(
    `Local Authority`,
    `Total local authority collected waste (tonnes)`
  )

lacw_suffolk_21 <- lacw_suffolk |>
  dplyr::filter(`Financial Year` == "2021-22") |>
  dplyr::select(
    `Local Authority`,
    `Total local authority collected waste (tonnes)`
  )
```

\newpage

# Waste Managed in Suffolk

## Local Authority Collected Waste

The total amount of Local Authority Collected Waste (LACW) in Suffolk, after a reduction dip in 2020-21, has increased again to a similar level as before the pandemic as shown in Figure \@ref(fig:totallocalauthority):

```{r totallocalauthority,  fig.alig = "center", fig.height = 4, fig.width = 8, fig.cap = "\\label{fig:totallocalauthority}Source: [ENV18 - Local Authority Collected Waste](https://www.gov.uk/government/statistical-data-sets/env18-local-authority-collected-waste-annual-results-tables)"}

p1 <- sccthemes::scc_barchart(
  lacw_scc,
  "Financial Year",
  "Total local authority collected waste (tonnes)",
  title = "Total local authority collected waste (tonnes)"
)

p1
```

Household waste arising has also returned to a level similar to that before 2020-21, as shown in Figure \@ref(fig:householdwaste).

This is in line of expectation, and similar to the national picture, which saw household waste increase with the easing of lockdown in Spring 2021.

Consumption overall may have reduced as a result of lower economic activity in 2020-21, and returned to previous levels as economic activity has ramped up again in 2021-22.

```{r householdwaste, fig.alig = "center", fig.height = 4, fig.width = 8, fig.cap = "Source: [ENV18 - Local Authority Collected Waste](https://www.gov.uk/government/statistical-data-sets/env18-local-authority-collected-waste-annual-results-tables)"}
p2 <- sccthemes::scc_barchart(
  lacw_scc,
  "Financial Year",
  "Household - total waste (tonnes)",
  title = "Household - total waste (tonnes)"
)

p2
```

## Waste sent to Recycling and Recycling Rates

The amount of LACW sent for recycling has steadily reduced between 2015-16 and 2020-21, as shown in Figure \@ref(fig:sentforrecycling).
In 2021-22 however, there is again an increase in the amount of household waste set for recycling/composting/reuse.
It should be noted however that it is still a smaller when compared to 2019-20, pre-pandemic.

```{r sentforrecycling, fig.alig = "center", fig.height = 4, fig.width = 8, fig.cap = "Source: [ENV18 - Local Authority Collected Waste](https://www.gov.uk/government/statistical-data-sets/env18-local-authority-collected-waste-annual-results-tables)"}
p3 <- sccthemes::scc_barchart(
  lacw_scc,
  "Financial Year",
  "Household - waste sent for recycling-composting-reuse (tonnes)",
  title = "Household - waste sent for recycling-composting-reuse (tonnes)"
)

p3
```

Suffolk historically had one of the highest recycling rates in England but this has reduced in all the Suffolk Districts over the past seven years as shown in Table \@ref(tab:recyclingrates). It should be noted that the recycling rate in Suffolk is now lower than the official recycling rate in England as a whole (44.1%).

Compared to last year, the recycling rate as a percentage has stayed constant. This indicates that, although in absolute tonnage more household waste has been sent for recycling/composting/reuse in 2021-22, as shown in Table \@ref(fig:sentforrecycling), this is a result the total local authority collected waste increasing and not due to an increase in the recycling rates.

```{r recyclingrates, ft.align = "center", tab.id = "recyclingrates", label = "recyclingrates", tab.cap = "Source: [ENV18 - Local Authority Collected Waste](https://www.gov.uk/government/statistical-data-sets/env18-local-authority-collected-waste-annual-results-tables)"}

recycling_rates <- lacw_scc |>
  dplyr::mutate(recycling_rates = round((`Local authority collected waste - sent for recycling-composting-reuse (tonnes)` / `Total local authority collected waste (tonnes)` * 100), 1)) |>
  dplyr::select(`Financial Year`, recycling_rates)

colnames(recycling_rates) <- c("Financial Year", "% sent for recycling")

recycling_rates |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::theme_vanilla()
```

The LACW recycling rate is shown in Figure \@ref(fig:districtrecyclingratedistricts) for each of the Suffolk Districts.
These have been subject to some reorganisaition in recent years and so the graphs below show the rates for the combines councils before each merger and the current district.
It is possible that the process of re-organisation has disrupted services to some extent.

From 2019 - 20, Suffolk Coastal District Council and Waveney District Council merged to become East Suffolk Council, and Forest Heath District Council and St Edmundsbury Borough Council merged to become West Suffolk Council.
Their figures have been aggregated in their respective Councils.

```{r districtrecyclingratedistricts, message = FALSE, fig.alig = "center", fig.height = 8, fig.width = 8, fig.cap = "Source: [ENV18 - Local Authority Collected Waste](https://www.gov.uk/government/statistical-data-sets/env18-local-authority-collected-waste-annual-results-tables)"}
district_plot <- lapply(unique(lacw_suffolk$`Local Authority`), function(authority) {
  district_council <- lacw_suffolk |>
    dplyr::filter(`Local Authority` == authority)
  
  recycling_rates <- district_council |>
    dplyr::mutate(
      recycling_rates = (`Local authority collected waste - sent for recycling-composting-reuse (tonnes)` /
                           `Total local authority collected waste (tonnes)`) * 100
    ) |>
    dplyr::select(`Financial Year`, recycling_rates)
  
  colnames(recycling_rates) <- c("Financial Year", "% sent for recycling")
  
  p4 <- sccthemes::scc_barchart_pct(
    recycling_rates,
    "Financial Year",
    "% sent for recycling",
    title = authority
  )
  
  p4
})

do.call(
  gridExtra::grid.arrange,
  c(
    district_plot,
    ncol = 1,
    top = "Recycling rate by district council"
  )
)
```

## Case Study: Food Waste Collection

Currently no food waste is collected separately in Suffolk. However, as part of the Environment Act 2021 authorities will be expected to collect food waste separately at least once a week. Authorities which do not have an existing food waste collection contract in place, will be expected to make arrangements by the 2024/25 financial year at the latest.

```{r foodwaste, message = FALSE}
folder <- paste0(here::here("Data"), "/")

food_waste <- read.csv(
  paste0(
    folder,
    "Waste_collection_and_recycling_England_data_2021-22.csv"
  ), skip = 1
) |> 
  janitor::clean_names() |> 
  dplyr::filter(
    row_text == "Waste food only" &
      col_text == "Tonnage collected for recycling"
  ) |> 
  dplyr::select(
    authority,
    data
  )

food_waste$data <- as.numeric(food_waste$data)
food_waste <- food_waste |> 
  dplyr::group_by(authority) |> 
  dplyr::summarise(food_waste = sum(data))

all_lacw <- read_lacw(folder) |> 
  janitor::clean_names()

selected_lacw <- all_lacw |> 
  dplyr::filter(
    local_authority %in% food_waste$authority &
      financial_year == "2021-22"
  ) |> 
  dplyr::select(
    local_authority,
    household_total_waste_tonnes
  )

combined <- dplyr::left_join(
  food_waste,
  selected_lacw,
  by = c(
    "authority" = "local_authority"
  )
)

combined <- combined |> 
  dplyr::mutate(pct_total = (food_waste / household_total_waste_tonnes))

combined[is.na(combined)] <- 0

combined <- combined |> 
  dplyr::filter(food_waste > 10 & household_total_waste_tonnes > 0)
```

Although food waste is not collected in Suffolk, there are `r nrow(combined)` authorities in England that already collect food waste separately. To try and estimate how much food waste we might expect to arise, we can look at how much food waste is collected as a percentage of the total waste collected by these authorities.

To get an impression of the performance of neighbouring authorities, Table \@ref(tab:foodwastenearby) provides a summary of some of the neighbouring authorities that already collect food waste separately, and their food waste collection rates.

```{r foodwastenearby, message = FALSE, ft.align = "center", tab.id = "foodwastenearby", label = "foodwastenearby", tab.cap = "Source: [WasteDataFlow - Local Authority waste management](https://www.data.gov.uk/dataset/0e0c12d8-24f6-461f-b4bc-f6d6a5bf2de5/wastedataflow-local-authority-waste-management)"}
nearby_councils <- c(
  "Cambridge City and South Cambs Councils",
  "Colchester Borough Council",
  "Kings Lynn and West Norfolk Borough Council",
  "Maldon District Council",
  "Norwich City Council",
  "Peterborough City Council",
  "Tendring District Council"
)

nearby <- combined |> 
  dplyr::filter(authority %in% nearby_councils)

nearby |> 
  flextable::flextable() |> 
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(4),
    values = c("Food Waste Collection Rates in selected authorities near Suffolk, 2021-22")
  ) |>
  flextable::set_formatter(
    pct_total = function(x) sprintf( "%.2f%%", x*100 ) 
  ) |> 
  flextable::set_header_labels(
    authority = "Authority",
    food_waste = "Food Waste Collected (in t)",
    household_total_waste_tonnes = "Total Household Waste Collected (in t)",
    pct_total = "% Food Waste of Total Collected"
  ) |> 
  flextable::theme_vanilla() 
```

The national picture is showin in summary statistics, which are provided here in Table \@ref(tab:foodwastesummary).

```{r foodwastesummary, message = FALSE, ft.align = "center", tab.id = "foodwastesummary", label = "foodwastesummary", tab.cap = "Source: [WasteDataFlow - Local Authority waste management](https://www.data.gov.uk/dataset/0e0c12d8-24f6-461f-b4bc-f6d6a5bf2de5/wastedataflow-local-authority-waste-management)"}
fw_summary <- data.frame(unclass(summary(combined$pct_total)), check.names = FALSE, stringsAsFactors = FALSE)

fw_summary <- tibble::rownames_to_column(fw_summary, "summary_stat")
colnames(fw_summary) <- c("summary_stat", "pct")

fw_summary |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(2),
    values = c("Statistics for Food Waste as a percentage of total household waste collected, England 2021-22")
  ) |>
  flextable::set_formatter(
    pct = function(x) sprintf( "%.2f%%", x*100 ) 
  ) |> 
  flextable::set_header_labels(
    summary_stat = "Summary Statistic",
    pct = "Food waste collection rate"
  ) |> 
  flextable::theme_vanilla() 
```

The mean recycling rate of food waste across all authorities that collect it is **`r round(fw_summary$pct[fw_summary$summary_stat == "Mean"], 4) * 100`%**, with a minimum rate of **`r round(fw_summary$pct[fw_summary$summary_stat == "Min."], 4) * 100`%** and a maximum rate of **`r round(fw_summary$pct[fw_summary$summary_stat == "Max."], 4) * 100`%**. The 1st quartile and 3rd quartile indicate that, in simple terms, the rate for most authorities lies between **`r round(fw_summary$pct[fw_summary$summary_stat == "1st Qu."], 4) * 100` - `r round(fw_summary$pct[fw_summary$summary_stat == "3rd Qu."], 4) * 100` %**.

An exact number cannot be predicted. Therefore, using the summary statistics in Table \@ref(tab:foodwastesummary), we can estimate a likely range of food waste tonnage that might arise when food waste is collected separately.

By multiplying the total household waste collected in each of the districts, by the national food waste collection rates above, an estimated range is given in Figure \@ref(fig:foodwastepredicted).

```{r foodwastepredicted, fig.height = 4, fig.width = 8, fig.cap = "Source: [WasteDataFlow - Local Authority waste management](https://www.data.gov.uk/dataset/0e0c12d8-24f6-461f-b4bc-f6d6a5bf2de5/wastedataflow-local-authority-waste-management)"}
suffolk_fw <- lacw_suffolk |> 
  dplyr::filter(`Financial Year` == "2021-22") |> 
  dplyr::select(authority = `Local Authority`, household_total_waste_tonnes = `Household - total waste (tonnes)`)


suffolk_fw$min <- suffolk_fw$household_total_waste_tonnes * fw_summary$pct[fw_summary$summary_stat == "Min."]
suffolk_fw$qua_1st <- suffolk_fw$household_total_waste_tonnes * fw_summary$pct[fw_summary$summary_stat == "1st Qu."]
suffolk_fw$median <- suffolk_fw$household_total_waste_tonnes * fw_summary$pct[fw_summary$summary_stat == "Median"]
suffolk_fw$mean <- suffolk_fw$household_total_waste_tonnes * fw_summary$pct[fw_summary$summary_stat == "Mean"]
suffolk_fw$qua_3rd <- suffolk_fw$household_total_waste_tonnes * fw_summary$pct[fw_summary$summary_stat == "3rd Qu."]
suffolk_fw$max <- suffolk_fw$household_total_waste_tonnes * fw_summary$pct[fw_summary$summary_stat == "Max."]

ggplot2::ggplot(
  suffolk_fw,
  ggplot2::aes(
    x = as.factor(authority),
    ymin = min,
    lower = qua_1st, 
    middle = median,
    upper = qua_3rd, 
    ymax = max,
    fill = as.factor(authority)
  )
) +
  ggplot2::geom_boxplot(
    stat = "identity"
  )  +
  ggplot2::scale_fill_viridis_d() +
  ggplot2::labs(
    title = "Estimated Food Waste arising from Households in Suffolk",
    subtitle = "for each District/Borough, generated using national food waste collection rates."
  ) +
  coord_flip() +
  sccthemes::scc_style()+
  ylab("Estimated Food Waste (in t)") +
  theme(
    axis.title.x = element_text()
  )
```
The totals displayed in Figure \@ref(fig:foodwastepredicted) are stated in Table \@ref(tab:foodwasteestimate). This shows the estimated tonnage of food waste, where the lowest estimate is equivalent to the lowest food waste collection rate in England, low is equivalent to the 1st quartile in the England etc.

```{r foodwasteestimate, message = FALSE, ft.align = "center", tab.id = "foodwasteestimate", label = "foodwasteestimate", tab.cap = "Source: [WasteDataFlow - Local Authority waste management](https://www.data.gov.uk/dataset/0e0c12d8-24f6-461f-b4bc-f6d6a5bf2de5/wastedataflow-local-authority-waste-management)"}
suffolk_rates <- suffolk_fw |> 
  dplyr::select(-household_total_waste_tonnes, -mean) 

estimate_totals <- data.frame(
  authority = c("Suffolk Total"),
  min = sum(suffolk_rates$min),
  qua_1st = sum(suffolk_rates$qua_1st),
  median = sum(suffolk_rates$median),
  qua_3rd = sum(suffolk_rates$qua_3rd),
  max = sum(suffolk_rates$max)
)

suffolk_rates <- dplyr::bind_rows(suffolk_rates, estimate_totals)

suffolk_rates |> 
  flextable::flextable() |> 
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(6),
    values = c("Estimated Food Waste arising from Households in Suffolk, England 2021-22 (tonnes)")
  ) |>
  flextable::colformat_double(
    j = c(
      "min", 
      "qua_1st",
      "median",
      "qua_3rd",
      "max"),
    digits = 0
    ) |> 
  flextable::set_header_labels(
    authority = "Authority",
    min = "Lowest Estimate",
    qua_1st = "Low Estimate",
    median = "Median Estimate",
    qua_3rd = "High Estimate",
    max = "Highest Estimate"
  ) |> 
  flextable::bold(i = 5, j = 1:6, part = "body") |>
  flextable::theme_vanilla() 
```

It is therefore estimated that Suffolk will need at the very least a capacity of **`r totals_formatting(round(suffolk_rates$qua_1st[suffolk_rates$authority == "Suffolk Total"], 0))` t**, but to decrease the likelihood the food waste stream does not exceed capacity, a capacity between **`r totals_formatting(round(suffolk_rates$median[suffolk_rates$authority == "Suffolk Total"], 0))` t - `r totals_formatting(round(suffolk_rates$qua_3rd[suffolk_rates$authority == "Suffolk Total"], 0))` t** would be more desirable. Any applications that would take capacity over **`r totals_formatting(round(suffolk_rates$max[suffolk_rates$authority == "Suffolk Total"], 0))` t**, would need to provide a robust evidence base that there is a requirement for that capacity, as this is equivalent to the highest food waste collection rate in England as of 2021-22.

To provide this capacity for recycling food waste, a likely destination will be anaerobic digestion plants. The Anaerobic Digestion and Bioresources Association (ADBA) have published a report outlining how local authorities can comply with changes in the law. ADBA's report can be found [here](https://adbioresources.org/food-waste-recycling-and-ad/).

AD plants receive a range of waste streams, and not all AD plants will be able to take household food waste. Any existing AD capacity, may therefore not equal to "free" capacity for food waste, and the additional capacity stated above may still be required as an addition. Suffolk's current composition and volume of AD treatment waste received will be covered in Section 4.

\newpage

# Waste Capacity

## Waste Treatment

The capacity of waste management infrastructure has been calculated using the throughput of the facilities in the Plan Area as recorded in the Waste Data Interrogator.
Shown in Table \@ref(tab:wastecapacity) The amount of waste managed in all facilities in Suffolk increased from 2019 to 2020 and in particular the amount of waste managed at the Energy from Waste facility at Great Blakenham increased following the grant of planning permission to enable it to manage 295,000 tonnes per annum, an increase from the original capacity of 269,000 tonnes per annum.


```{r wastecapacity, ft.align = "center", tab.id = "wastecapacity", label = "wastecapacity", tab.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}
# NOTE: the WDI is published in a .xlsb format, which is notoriously difficult to read.
# A package, {xlsb} does exist with a read_xslb() function, unfortunately at the time of writing not available for my version of R.
# So... the "YEAR Waste Received" sheet was copied into a standalone .xlsx file
# Copy pasting data is generally bad practice (because it is prone to user error),
# But I had no other option in this instance
wdi_totals_table <- wamreport$wdi_totals |>
  tidyr::pivot_wider(names_from = `year`, values_from = `tonnes`)

wdi_totals_table <- wdi_totals_table |>
  dplyr::filter(!`Site Category` %in% c("Landfill", "Storage", "Mobile Plant"))

wdi_totals_table[is.na(wdi_totals_table)] <- 0

wdi_names <- c("Category", "2019", "2020", "2021")
colnames(wdi_totals_table) <- wdi_names

treated_totals <- data.frame(
  `Category` = c("Total waste treated in Suffolk"),
  `2019` = sum(wdi_totals_table$`2019`),
  `2020` = sum(wdi_totals_table$`2020`),
  `2021` = sum(wdi_totals_table$`2021`)
)
colnames(treated_totals) <- wdi_names

totals_formatting <- function(x) {
  x <- format(round(x, 0), big.mark = ",")
  x
}

wdi_totals_table <- dplyr::bind_rows(wdi_totals_table, treated_totals)
wdi_totals_table$`2019` <- totals_formatting(wdi_totals_table$`2019`)
wdi_totals_table$`2020` <- totals_formatting(wdi_totals_table$`2020`)
wdi_totals_table$`2021` <- totals_formatting(wdi_totals_table$`2021`)

wdi_totals_table |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(4),
    values = c("Waste treated in facilities in Suffolk in 2019, 2020 and 2021 (tonnes)")
  ) |>
  flextable::bold(i = 7, j = 1:4, part = "body") |>
  flextable::theme_vanilla() |>
  flextable::footnote(i = 7, j = 1, 
                      value = flextable::as_paragraph(
                        c(
                          "Previous reports have included figures for 'Mobile Plants' sites. EA have removed geographical descriptors for this Category, so it can no longer be reported on County level. Therefore totals may be down from previous reports."
                        )
                      ),
                      ref_symbols = c("*"),
                      part = "body")
```

Total waste treated in Table \@ref(tab:wastecapacity) does not include landfill.
Figure \@ref(fig:wastecapacityplot) shows Landfill alongside other categories, to give an idea of scale.

```{r wastecapacityplot, fig.height = 4, fig.width = 8, fig.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}
wdi_plotted <- wamreport$wdi_totals |>
  dplyr::filter(!`Site Category` %in% c("Mobile Plant", "Storage"))

sccthemes::scc_barchart_grouped(
  wdi_plotted,
  "Site Category",
  "tonnes",
  "year",
  title = "Waste treated in Suffolk (tonnes)"
) +
  ggplot2::scale_fill_manual(values = c("#e2eefa", "#2d6ca2", "#e8850c"))

```

### Waste to Anaerobic Landfill
Following on from the Case Study: Food Waste Collection, current anaerobic digestion treatment in Suffolk is presented in Table \@ref(tab:tabad).

```{r waste_to_anaerobic, warning = FALSE, ft.align = "center", tab.id='tabad', label = 'tabad', tab.cap =  "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}
ad_summary <- wdi_data |> 
  dplyr::filter(
    `Facility Type`
    %in%
      c("Anaerobic digestion", "Anaerobic Digestion") &
      `Facility WPA` == "Suffolk") |> 
  dplyr::group_by(
    `Site Name`,
    `year`
  ) |> 
  dplyr::summarise(
    tonnes = sum(`Tonnes Received`)
  )

ad_2021 <- ad_summary |> 
  dplyr::filter(year == 2021)

ad_summary_yearly <- tidyr::pivot_wider(
  ad_summary,
  names_from = year,
  values_from = tonnes
)

ad_summary_yearly <- ad_summary_yearly |> 
  dplyr::mutate_all(~replace(., is.na(.), 0))

ad_summary_yearly$`2019` <- totals_formatting(ad_summary_yearly$`2019`)
ad_summary_yearly$`2020` <- totals_formatting(ad_summary_yearly$`2020`)
ad_summary_yearly$`2021` <- totals_formatting(ad_summary_yearly$`2021`)

ad_summary_yearly |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(4),
    values = c("Waste treated in anaerobic digestion plants in Suffolk in 2019, 2020 and 2021 (tonnes)")
  ) |>
  flextable::theme_vanilla()
```

The tonnage of waste treated in 2021, totals **`r totals_formatting(sum(ad_2021$tonnes))`t**. All waste treated here is classed as "animal faeces, urine and manure (including spoiled straw), effluent, collected separately and treated off-site". These sites therefore do not currently accept municipal food waste, nor may they be suitable to do so.

## Waste to Landfill

Figure \@ref(fig:wastetolandfill) shows active Landfill sites.
There is only one active landfill site receiving non-hazardous waste in Suffolk and this is Masons Landfill site which is operated by Valencia Waste Management.

Other large recipients of waste to landfill are Shrublands Quarry and Lawn Farm Quarry, both of which receive significant quantities of inert waste.

```{r wastetolandfill, warning = FALSE, fig.alig = "center", fig.height = 6, fig.width = 8, fig.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}

landfill_totals <- wamreport$totals_by_site
landfill_totals$`Site Name` <- gsub("EPR", "", landfill_totals$`Site Name`)
landfill_totals$`Site Name` <- gsub("BV4517IM", "", landfill_totals$`Site Name`)
landfill_totals$`Site Name` <- gsub("\\/", "", landfill_totals$`Site Name`)
landfill_totals$`Site Name` <- gsub(" - ", "", landfill_totals$`Site Name`)

landfill_totals <- landfill_totals |>
  dplyr::filter(`Site Category` == "Landfill")

landfill_totals <- landfill_totals[order(-landfill_totals$tonnes),]

sccthemes::scc_barchart_grouped(
  landfill_totals,
  "Site Name",
  "tonnes",
  "year",
  title = "Waste Received to Landfill in Suffolk (tonnes)"
) +
  ggplot2::theme(
    axis.text.x = ggplot2::element_text(
      size = 10, 
      angle = 45, 
      hjust = 1)
  ) +
  ggplot2::scale_fill_manual(
    values = c(
      "#e2eefa",
      "#2d6ca2",
      "#e8850c")
  )
```

## Remaining landfill capacity

Permitted landfill operators have a condition in their permits to report the remaining landfill void (capacity) of their sites at the end of the calendar year.
Operators can claim commercial confidentiality.
See Table \@ref(tab:tablc)

```{r tablc, message = FALSE, warning = FALSE, ft.align = "center", tab.id='tablc', label = 'tablc', tab.cap = "Source: [Remaining Landfill Capacity 2019, 2020 and 2021.](https://www.data.gov.uk/dataset/237825cb-dc10-4c53-8446-1bcd35614c12/remaining-landfill-capacity)"}
capacity <- wamreport$rlc_capacity

capacity |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(6),
    values = c("Remaining landfill capacity reported in Suffolk (cubic metres)")
  ) |>
  flextable::theme_vanilla()
```

In Figure \@ref(fig:landfillcapacityplot) Landfill capacity change is shown between 2019 and 2021, for sites where there is capacity.

```{r landfillcapacityplot, fig.height = 6, fig.width = 8, fig.cap = "Source: [Remaining Landfill Capacity 2019, 2020 and 2021](https://www.data.gov.uk/dataset/237825cb-dc10-4c53-8446-1bcd35614c12/remaining-landfill-capacity)"}
capacity_plot <- tidyr::pivot_longer(
  capacity, 
  cols = c(`2019`, `2020`, `2021`), 
  names_to = "year",
  values_to = "cubic_metres"
)

capacity_plot <- capacity_plot |>
  dplyr::filter(cubic_metres > 0)

sccthemes::scc_barchart_grouped(
  capacity_plot,
  "Facility",
  "cubic_metres",
  "year",
  title = "Remaining Landfill capacity by Facility in Suffolk (cubic metres)") +
  ggplot2::scale_fill_manual(
    values = c(
      "#e2eefa",
      "#2d6ca2",
      "#e8850c"
    )
  ) +
  ggplot2::theme(axis.text.x = ggplot2::element_text(size = 10, angle = 45, hjust = 1))
```

\newpage

# Waste Movements
## Waste Managed in Suffolk from other Waste Planning Authorities

To determine whether Suffolk achieves its goal of net self-sufficiency in the management of waste arising wihin the Plan Area, we can look at the movement of waste in and out of the County.

Table \@ref(tab:tab1) shows all waste managed in Suffolk, and the Waste Planning Authority (WPA) from which the waste originated. It shows the figures for Suffolk, all our nearest neighbours, as well as 'All Other WPAs' combined.


```{r waste_managed_in_suffolk, ft.align = "center", tab.id='tab1', label = 'tab1', tab.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}
wdi_origin <- wamreport$waste_origin

relevant_counties <- c(
  "Suffolk",
  "Norfolk",
  "Essex",
  "Cambridgeshire"
)

counties <- wdi_origin |>
  dplyr::filter(`Origin WPA` %in% relevant_counties)
other <- wdi_origin |>
  dplyr::filter(!`Origin WPA` %in% relevant_counties) |>
  dplyr::select(tonnes, year) |>
  dplyr::group_by(year) |>
  dplyr::summarise(tonnes = sum(tonnes))

other$`Origin WPA` <- "All Other WPAs"

wdi_origin_table <- dplyr::bind_rows(counties, other)

wdi_origin_table <- wdi_origin_table |>
  tidyr::pivot_wider(names_from = `year`, values_from = `tonnes`)
wdi_origin_table <- wdi_origin_table[(order(-wdi_origin_table$`2020`)), ]

suffolk_total <- wdi_origin_table |>
  dplyr::filter(`Origin WPA` == "Suffolk")

from_others <- data.frame(
  `Origin` = c("Total waste managed origin outwith Suffolk"),
  `2019` = sum(wdi_origin_table$`2019`) - suffolk_total$`2019`,
  `2020` = sum(wdi_origin_table$`2020`) - suffolk_total$`2020`,
  `2021` = sum(wdi_origin_table$`2021`) - suffolk_total$`2021`
)

managed_totals <- data.frame(
  `Origin` = c("Total waste managed in Suffolk"),
  `2019` = sum(wdi_origin_table$`2019`),
  `2020` = sum(wdi_origin_table$`2020`),
  `2021` = sum(wdi_origin_table$`2021`)
)
colnames(from_others) <- colnames(wdi_origin_table)
colnames(managed_totals) <- colnames(wdi_origin_table)

wdi_origin_table <- dplyr::bind_rows(wdi_origin_table, from_others)
wdi_origin_table <- dplyr::bind_rows(wdi_origin_table, managed_totals)

wdi_origin_table$`2019` <- totals_formatting(wdi_origin_table$`2019`)
wdi_origin_table$`2020` <- totals_formatting(wdi_origin_table$`2020`)
wdi_origin_table$`2021` <- totals_formatting(wdi_origin_table$`2021`)

wdi_origin_table |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(4),
    values = c("All waste managed in Suffolk (tonnes)")
  ) |>
  flextable::bold(i = 6:7, j = 1:4, part = "body") |>
  flextable::italic(i = 4, j = 1, part = "body") |> 
  flextable::theme_vanilla()
```

Table \@ref(tab:tab2) is a further breakdown of Table \@ref(tab:tab1) showing all waste sent to landfill in Suffolk, and the WPA from which the waste originated.

```{r waste_to_landfill2, ft.align = "center", tab.id='tab2', label='tab2', tab.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}
wdi_landfill <- wamreport$landfill_waste

counties_landfill <- wdi_landfill |>
  dplyr::filter(`Origin WPA` %in% relevant_counties)
other_landfill <- wdi_landfill |>
  dplyr::filter(!`Origin WPA` %in% relevant_counties) |>
  dplyr::select(tonnes, year) |>
  dplyr::group_by(year) |>
  dplyr::summarise(tonnes = sum(tonnes))

other_landfill$`Origin WPA` <- "All Other WPAs"

wdi_landfill_table <- dplyr::bind_rows(counties_landfill, other_landfill)

wdi_landfill_table <- wdi_landfill_table |>
  tidyr::pivot_wider(names_from = `year`, values_from = `tonnes`)
wdi_landfill_table <- wdi_landfill_table[(order(-wdi_landfill_table$`2020`)), ]

wdi_landfill_table[is.na(wdi_landfill_table)] <- 0

landfill_totals <- data.frame(
  `Origin` = c("Landfill total in Suffolk"),
  `2019` = sum(wdi_landfill_table$`2019`),
  `2020` = sum(wdi_landfill_table$`2020`),
  `2021` = sum(wdi_landfill_table$`2021`)
)

colnames(landfill_totals) <- colnames(wdi_landfill_table)

wdi_landfill_table <- dplyr::bind_rows(wdi_landfill_table, landfill_totals)

wdi_landfill_table$`2019` <- totals_formatting(wdi_landfill_table$`2019`)
wdi_landfill_table$`2020` <- totals_formatting(wdi_landfill_table$`2020`)
wdi_landfill_table$`2021` <- totals_formatting(wdi_landfill_table$`2021`)

wdi_landfill_table |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(4),
    values = c("Waste sent to landfill in Suffolk (tonnes)")
  ) |>
  flextable::bold(i = 6, j = 1:4, part = "body") |>
  flextable::italic(i = 4, j = 1, part = "body") |> 
  flextable::theme_vanilla()

```

## Waste from Suffolk managed in other Waste Planning Authorities

The total amount of waste sent **from** Suffolk to other WPAs is relatively modest as shown in Table \@ref(tab:tab3). Norfolk is by far the largest recipient of waste sent from Suffolk. This is in large part due to waste sent to Thetford Power Station, on the county border. This is explored in more detail in Table \@ref(tab:tab5).

```{r waste_from_Suffolk, ft.align = "center", tab.id='tab3', label='tab3', tab.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}
wdi_export <- wamreport$waste_destination

wdi_export$`Facility WPA`[is.na(wdi_export$`Facility WPA`)] <- "Other"

counties_export <- wdi_export |>
  dplyr::filter(`Facility WPA` %in% relevant_counties)

other_export <- wdi_export |>
  dplyr::filter(!`Facility WPA` %in% relevant_counties) |>
  dplyr::select(tonnes, year) |>
  dplyr::group_by(year) |>
  dplyr::summarise(tonnes = sum(tonnes))

other_export$`Facility WPA` <- "Other"

wdi_export_table <- dplyr::bind_rows(counties_export, other_export)

wdi_export_table <- wdi_export_table |>
  tidyr::pivot_wider(names_from = `year`, values_from = `tonnes`)
wdi_export_table <- wdi_export_table[(order(-wdi_export_table$`2021`)), ]

wdi_export_table[is.na(wdi_export_table)] <- 0

export_totals <- data.frame(
  `Origin` = c("Sent from Suffolk total"),
  `2019` = sum(wdi_export_table$`2019`),
  `2020` = sum(wdi_export_table$`2020`),
  `2021` = sum(wdi_export_table$`2021`)
)

colnames(export_totals) <- colnames(wdi_export_table)

wdi_export_table <- dplyr::bind_rows(wdi_export_table, export_totals)

wdi_export_table$`2019` <- totals_formatting(wdi_export_table$`2019`)
wdi_export_table$`2020` <- totals_formatting(wdi_export_table$`2020`)
wdi_export_table$`2021` <- totals_formatting(wdi_export_table$`2021`)

wdi_export_table |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(4),
    values = c("Waste sent to other authorities from Suffolk (tonnes)")
  ) |> 
  flextable::bold(i = 5, j = 1:4, part = "body") |>
  flextable::theme_vanilla()
```

## Net self-sufficiency

In past years Suffolk has largely achieved the goal of net self-sufficiency in the management of the waste arising within its area.

To demonstrate this, we can calculate the net flow of waste in or out of the county. The net flow is calculated by taking the "Total waste managed origin outwith Suffolk" in Table \@ref(tab:tab1), and subtracting the "Sent from Suffolk total" in Table \@ref(tab:tab3).

There was a net flow of waste into Suffolk of **`r totals_formatting(from_others$"2019" - export_totals$"2019")` tonnes** in 2019, and a net flow into the county of **`r totals_formatting(from_others$"2020" - export_totals$"2020")` tonnes** in 2020.

In 2021 there is a net flow out of the county of **`r totals_formatting(export_totals$"2021" - from_others$"2021")` tonnes**. This is a large change in the flow of waste in Suffolk, however the reasons for this increase in 2021 net flow out of the county, are covered in Table \@ref(tab:tab5).

## In-depth: Waste Water Treatment

Of the tonnages sent from Suffolk to Norfolk, a large proportion comprised sludge which was sent to facilities managed by Anglian Water, as highlighted in blue in Table \@ref(tab:tab4).

```{r suffolk_to_norfolk, warning = FALSE, message = FALSE, ft.align = "center", tab.id='tab4', label='tab4', tab.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}
wdi_norfolk <- wamreport$od_waste

aw2019 <- wdi_norfolk |>
  dplyr::filter(
    Operator %in% c(
      "Anglian Water Services Limited",
      "Anglian Water Services Ltd"
    ) &
      year == "2019"
  )

aw2019 <- sum(aw2019$tonnes)

aw2020 <- wdi_norfolk |>
  dplyr::filter(
    Operator %in% c(
      "Anglian Water Services Limited",
      "Anglian Water Services Ltd"
    ) &
      year == "2020"
  )

aw2020 <- sum(aw2020$tonnes)

aw2021 <- wdi_norfolk |>
  dplyr::filter(
    Operator %in% c(
      "Anglian Water Services Limited",
      "Anglian Water Services Ltd"
    ) &
      year == "2021"
  )

aw2021 <- sum(aw2021$tonnes)

wdi_norfolk$tonnes <- totals_formatting(wdi_norfolk$tonnes)

wdi_norfolk <- tidyr::pivot_wider(
  wdi_norfolk,
  names_from = year,
  values_from = tonnes
)

wdi_norfolk <- wdi_norfolk |> 
  dplyr::select(
    `Site Name`,
    Operator,
    `2019`,
    `2020`,
    `2021`
  )

wdi_norfolk[1:7, ] |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(5),
    values = c(
      "Waste sent to Norfolk from Suffolk (tonnes), highlighting Anglian Water"
    )
  ) |>
  #bold(i = c(1,3,6), j = 1:4, part = "body") |>
  flextable::bg(i = c(2, 3, 7), j = 1:5, part = "body", bg = "#e2eefa") |>
  # color(i = c(1,3,6), j = 1:4, part = "body", color = "white") |>
  flextable::theme_vanilla()
```

In 2019, `r totals_formatting(aw2019)` tonnes of sludges were sent to Whitlingham Sludge Treatment Centre, Thetford Sludge Treatment Centre and King's Lynn Sludge Treatment Centre in Norfolk by Anglian Water.
In 2020, `r totals_formatting(aw2020)` tonnes of sludges were sent to these facilities, and `r totals_formatting(aw2021)` in 2021.

Although in 2020 the total nearly halved, the reduction 2021 has slowed.
This implies that there is still a shortage of waste water treatment capacity in Suffolk and discussions with the Anglian Water would be useful to identify their needs to enable Suffolk to become more self-sufficient in managing this waste stream.

## In-depth: Thetford Power Station

```{r thetford, warning = FALSE, message = FALSE, ft.align = "center", tab.id='tab5', label='tab5', tab.cap = "Source: [Waste Data Interrogator 2019](https://find-data-beta.cloudapps.digital/dataset/d409b2ba-796c-4436-82c7-eb1831a9ef25/2019-waste-data-interrogator), [2020](https://www.data.gov.uk/dataset/bb40d091-a346-4b75-aa54-df7d347bed93/2020-waste-data-interrogator) and [2021](https://www.data.gov.uk/dataset/d8a12b93-03ef-4fbf-9a43-1ca7a054479c/2021-waste-data-interrogator)."}

wdi_thetford <- wdi_norfolk |> 
  dplyr::filter(Operator == "EPR Thetford Limited")

od_waste <- wamreport$od_waste

numeric_thetford <- od_waste |>
  dplyr::filter(Operator == "EPR Thetford Limited" & year == 2021)

numeric_all <- od_waste |> 
  dplyr::filter(year == 2021)

wdi_norfolk[1:3, ] |>
  flextable::flextable() |>
  flextable::set_table_properties(layout = "autofit") |>
  flextable::add_header_row(
    colwidths = c(5),
    values = c(
      "Waste sent to Norfolk from Suffolk (tonnes), highlighting Thetford Power Station"
    )
  ) |>
  flextable::bg(i = c(1), j = 1:5, part = "body", bg = "#e2eefa") |>
  flextable::theme_vanilla()
```

Of the waste Suffolk sends to Norfolk, one remarkable rise is in amount of waste sent to Thetford Power Station, from `r wdi_thetford$"2020"` tonnes in 2020 to `r wdi_thetford$"2021"` tonnes in 2021. Thetford Power Station is an Animal By-Products Incinerator, [which converts poultry litter into electricity](https://www.mreuk.com/thetford). It is in close proximity to the Suffolk border. 

This destination alone counts for **`r round((numeric_thetford$tonnes/sum(numeric_all$tonnes)) * 100, 1)`%** of export to Norfolk, and alone is larger than the total net flow out of Suffolk (**`r totals_formatting(export_totals$"2021" - from_others$"2021")` tonnes**) in 2021. Without this particular waste flow Suffolk would still be a net recipient of waste. 

This is a destination that should be monitored in future reports. However, due to its close proximity to the border, it is unlikely that the provision of an alternative site needs to be provided, or would indeed be viable for this waste stream, unless the tonnage grows significantly.

While this site changes Suffolk from a net recipient to a net exporter of waste, and therefore technically making Suffolk not net self-sufficient, due to the factors described above no further action or policy changes is required.

**TZ: There is probably a better, more formal way of describing this.**

\newpage

# Performance of the Waste Policies and Conclusions

The outcome of the waste planning process in Suffolk has been to deliver broadly sufficient capacity of waste management facilities to manage the waste arising within the County. This includes a wide variety of treatment facilities to manage different types of materials, an energy from waste facility to manage residual waste from household, commercial and industrial sources, and sufficient landfill to dispose of the remainder.

Efforts to reduce, reuse and recycle waste will continue, particularly in the context of the implementation of the Government's Resources and Waste Strategy which was published in 2018. This is becoming more urgent, as Suffolk's recycling rate is falling behind England's national recycling rate.

This proposes more separate collection of food waste and the separate collection of other easily recyclable materials and so consideration will need to be given to the delivery of bulking and transfer stations that may be associated with this.

As suggested in a previous iteration of this report, consideration may need to be given to the development of additional waste water treatment capacity, given the significant movements of sludges out of the Plan Area and liaison with Anglian Water will be needed to take this forward.

\newpage

# Appendix

## Waste Planning applications
Mineral and waste planning applications determined by Suffolk County Council **1st April 2021 to 31st March 2022**.

```{r applications, warning = FALSE, message = FALSE}

folder <- paste0(here::here("Data"), "/")

applications <- readxl::read_excel(paste0(folder, "appendix_applications.xlsx"))

approval_codes <- data.frame(
  code = c(
    "AD",
    "APC",
    "APP",
    "COM"
  ),
  descriptions = c(
    "Awaiting Decision",
    "App/Conds",
    "Approved",
    "Comments"
  )
)

applications <- dplyr::left_join(
  applications,
  approval_codes,
  by = c("decision" = "code")) |> 
  dplyr::select(
    application_number,
    location,
    proposal,
    notice_date,
    decision = descriptions
  )

applications$notice_date <- as.Date(applications$notice_date)

applications |>
  flextable::flextable() |>
  flextable::set_header_labels(
    values = list(
      application_number = "Application Number",
      location = "Location",
      proposal = "Proposal",
      notice_date = "Notice Date",
      decision = "Decision"
    )
  ) |> 
  flextable::set_table_properties(layout = "autofit") |>
  flextable::theme_vanilla()
```
